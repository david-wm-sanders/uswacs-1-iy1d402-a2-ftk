% !TEX TS-program = pdflatex
\documentclass[12pt]{article}

% Package the packages
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[a4paper, margin=0.75in]{geometry}
\usepackage{enumitem}
\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue]{hyperref}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[round]{natbib}
\usepackage{pdfpages}
\usepackage{fancyvrb}
% \usepackage[parfill]{parskip}
% \usepackage{titlesec}
\usepackage{listings}
% \usepackage{graphicx}
% \usepackage{float}
% \usepackage[british]{babel}
% \usepackage{csquotes}
\usepackage{tabularx, makecell}
% -

% Configuration
% Change font to Palatino
\renewcommand{\rmdefault}{ppl}
% Change the list item spacing
\setlist{noitemsep}
% Set the bibliography style
\bibliographystyle{usw}
% Set up better chapter titling
% \titleformat{\chapter}{\normalfont\LARGE\bfseries}{\thechapter.}{12pt}{}
% \titlespacing{\chapter}{0pt}{0pt}{12pt}
% \titleformat{\section}{\normalfont\Large\bfseries}{\thesection}{12pt}{}
% \titlespacing{\section}{0pt}{0pt}{6pt}
% \titleformat{name=\section,numberless}{\normalfont\Large\bfseries}{}{0pt}{}
% \titleformat{\subsection}{\normalfont\large\bfseries}{\thesubsection}{12pt}{}
% \titleformat{name=\subsection,numberless}{\normalfont\large\bfseries}{}{0pt}{}
% \titlespacing{\subsection}{0pt}{0pt}{3pt}
% Set up the images path
% \graphicspath{ {deliverables/screenshots/} }
% -

% Custom functions
% Set up an inline todo command
\newcommand{\todo}[1]{\textcolor{red}{todo: #1}}
% Set up a todo environment
\newenvironment{todoenv}
  {\color{red}todo:}
  {\color{black}}
% Set up a terminal command block
\definecolor{light-gray}{gray}{0.95}
\newcommand{\term}[1]{\colorbox{light-gray}{\texttt{#1}}}

% Definitions
% \title{IY1D402\thanks{National Cyber Security Academy, University of South Wales, UK}\\{\textit{\small Cyber Security Tools And Practices}}\\SCADA Investigative Report}
\title{IY1D402{\textit{\small \\Cyber Security Tools And Practices}}\\FTK Forensics Report}
\author{David Sanders\\{\LARGE 17135397}}
\date{\today}
% -

% Document
\begin{document}

% Cover page setup
\maketitle
\pagebreak
% \fontsize{11.5pt}{11.5pt}\selectfont
\tableofcontents
% \fontsize{12pt}{12pt}\selectfont
% -

% Introduction
\pagebreak
\section{ACPO}
The \textit{ACPO Good Practice for Digital Evidence, Version 5} has been prepared by the Association of Chief Police Officers Lead for e-Crime to assist those involved, not just law enforcement, in investigating crime and cyber security incidents.

There are four guiding principles:
\paragraph{Principle 1}
``No action taken by law enforcement agencies, persons employed within those agencies or their agents should change data which may subsequently be relied upon in court.''
\paragraph{Principle 2}
``In circumstances where a person finds it necessary to access original data, that person must be competent to do so and be able to give evidence explaining the relevance and the implications of their actions.''
\paragraph{Principle 3}
``An audit trail or other record of all processes applied to digital evidence should be created and preserved. An independent third party should be able to examine those processes and achieve the same result.''
\paragraph{Principle 4}
``The person in charge of the investigation has overall responsibility for ensuring that the law and these principles are adhered to.''\\

In applying these principles, it is important to be aware of the following. The evidence which is produced in court is to be no more and no less at the time of presentation than it was when it was first taken into the possession of law enforcement and the onus is on the prosecution to show that this is the case. Operating systems and other programs frequently alter, add to, and delete the contents of electronic storage and this may happen automatically without the user being aware that the data has changed. It follows that an image should be made of the original data - creating an image will ensure that the original data is preserved so that an independent third-party can re-examine it if required. Images may be physical/logical block images of the entire device or a logical file image containing partial or selective data. Where data is only stored remotely in a location that is inaccessible, obtaining an image may be impossible. It is essential in such cases that only a person who is competent and appropriately trained accesses and recovers data. Objectivity must be displayed in a court of law as well as the integrity of evidence. Audit trails must be kept to demonstrate how evidence has been recovered -- all processes must be shown.
\pagebreak
\section{Example Templates}
In this section, I will provide examples of the tables used in this report.
\subsection{Hashes Template}
This is an example of the hash table template that is used to show the MD5 and SHA1 hashes of the evidence image so that it can be verified by those reading this report. It was auto-generated by the \texttt{make\_hash\_table\_latex.py} script.
{
\ttfamily\tiny
\begin{flushright}
MD5:4262ff3e3c24530bd4c5c97c0e2df4db
\end{flushright}
\vspace{-3.5em}
}
\begin{table}[h!]
\ttfamily\footnotesize
\setlength{\tabcolsep}{0.1cm}
\newcolumntype{k}{p{1cm}}
\newcolumntype{v}{c}
\begin{tabular}{|k|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|}
\hline
MD5 & 4 & 2 & 6 & 2 & f & f & 3 & e & 3 & c & 2 & 4 & 5 & 3 & 0 & b & d & 4 & c & 5 & c & 9 & 7 & c & 0 & e & 2 & d & f & 4 & d & b & - & - & - & - & - & - & - & - \tabularnewline \hline
SHA1 & d & 9 & 9 & 5 & 5 & 9 & 1 & d & e & b & 5 & 2 & c & 9 & 4 & a & c & 9 & 2 & 8 & a & 8 & f & 7 & 2 & 0 & f & b & c & a & 5 & 5 & a & f & 0 & 1 & d & 9 & 4 & 5 \tabularnewline \hline
\end{tabular}
\end{table}
{
\ttfamily\tiny
\vspace{-4.5em}
\begin{flushright}
SHA1:d995591deb52c94ac928a8f720fbca55af01d945
\end{flushright}
}
I have chosen to include the hashes outside the table as well -- this allows them to be searchable within the output PDF report.
\subsection{Artefact Template}
% \begin{table}[h!]
% \centering
% % \caption{My caption}
% % \label{my-label}
% \ttfamily
% % \small
% \newcolumntype{k}{p{3cm}}
% \newcolumntype{v}{X}
% \newcolumntype{t}{p{\textwidth - 4\tabcolsep - 3cm - 3\arrayrulewidth}}
% \begin{tabularx}{1\textwidth}{|k|v|k|v|}
% \hline
% FTK No.               & x                       & Evidence No.  & x  \tabularnewline \hline
% Filename              & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Hash (MD5)            & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Hash (SHA1)           & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Date Created          & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Date Modified         & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Date Accessed         & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Is deleted?           & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Size (L/P)            & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% File path             & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Evidence Description  & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Technique used        & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% Reason for selection  & \multicolumn{3}{t|}{x}                       \tabularnewline \hline
% \end{tabularx}
% \end{table}

\begin{table}[h!]
\centering
% \caption{My caption}
% \label{my-label}
\ttfamily
% \small
\newcolumntype{k}{p{3cm}}
\newcolumntype{v}{X}
\newcolumntype{t}{p{\textwidth - 4\tabcolsep - 3cm - 3\arrayrulewidth}}
\begin{tabularx}{1\textwidth}{|k|v|k|v|}
\hline
FTK No.  & \textit{FTK Item Number}  & Evidence No.  & \textit{Evidence Identifier}  \tabularnewline \hline
Filename  & \multicolumn{3}{t|}{\textit{name\_of\_file.ext}}  \tabularnewline \hline
Hash (MD5)  & \multicolumn{3}{t|}{\textit{MD5 hash of the file}}  \tabularnewline \hline
Hash (SHA1)  & \multicolumn{3}{t|}{\textit{SHA1 hash of the file}}  \tabularnewline \hline
Date Created  & \multicolumn{3}{t|}{\textit{The time at which the file was created}}  \tabularnewline \hline
Date Modified  & \multicolumn{3}{t|}{\textit{The time at which the file was last modified}}  \tabularnewline \hline
Date Accessed  & \multicolumn{3}{t|}{\textit{The time at which the file was last accessed}}  \tabularnewline \hline
Is deleted?  & \multicolumn{3}{t|}{\textit{Was the file deleted? Yes/No.}}  \tabularnewline \hline
Size (L/P)  & \multicolumn{3}{t|}{\textit{The logical/physical size of the file}}  \tabularnewline \hline
File path  & \multicolumn{3}{t|}{\textit{C:\textbackslash full\textbackslash path\textbackslash to\textbackslash file}}  \tabularnewline \hline
Evidence Description  & \multicolumn{3}{t|}{\textit{A description of the evidence}}  \tabularnewline \hline
Technique used  & \multicolumn{3}{t|}{\textit{The technique used to discover the evidence}}  \tabularnewline \hline
Reason for selection  & \multicolumn{3}{t|}{\textit{Why was this file was selected as evidence?}}  \tabularnewline \hline
\end{tabularx}
\end{table}

\pagebreak
\section{Evidence Listing and Reporting}
\subsection{Image Integrity Verification}
FTK Case Identifier: 17135397\_IY1D402\_CW2

Each time FTK was opened, the integrity of the evidence was verified inside FTK by using \texttt{Tools > Verify Image Integrity...}

The hashes calculated were:
{
\ttfamily\tiny
\begin{flushright}
MD5:265e715403af7777215295d6de5a8e57
\end{flushright}
\vspace{-3.5em}
}
\begin{table}[h!]
\ttfamily\footnotesize
\setlength{\tabcolsep}{0.1cm}
\newcolumntype{k}{p{1cm}}
\newcolumntype{v}{c}
\begin{tabular}{|k|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|v|}
\hline
MD5 & 2 & 6 & 5 & e & 7 & 1 & 5 & 4 & 0 & 3 & a & f & 7 & 7 & 7 & 7 & 2 & 1 & 5 & 2 & 9 & 5 & d & 6 & d & e & 5 & a & 8 & e & 5 & 7 & - & - & - & - & - & - & - & - \tabularnewline \hline
SHA1 & b & 7 & c & 5 & 5 & a & 7 & e & a & e & 2 & f & 3 & 1 & f & 9 & c & 6 & f & 7 & 6 & a & 0 & 2 & 8 & f & 8 & e & e & 8 & 8 & 3 & b & d & e & 5 & 4 & 2 & 0 & d \tabularnewline \hline
\end{tabular}
\end{table}
{
\ttfamily\tiny
\vspace{-4.5em}
\begin{flushright}
SHA1:b7c55a7eae2f31f9c6f76a028f8ee883bde5420d
\end{flushright}
}
FTK reports that these hashes were successfully verified against those calculated when the evidence image was taken.

\pagebreak
\subsection{Artefact 1}
% Name	Label	Item #	Ext	Path	Category	P-Size (bytes)	L-Size (bytes)	MD5	SHA1	SHA256	Created	Accessed	Modified
% Bad Guy.contact		1139	contact	Bad_Guy.E01/NONAME [FAT32]/[root]/Documents/soup/b/g/Bad Guy.contact	XML	8192	2069	721fa07cecb880951fb675944f3607b4	3c6df384298894d2db5b076cd3e566568c1db466		20/02/2018 12:05:58 (2018-02-20 12:05:58 UTC)	2018-02-20	20/02/2018 12:07:48 (2018-02-20 12:07:48 UTC)
\begin{table}[h!]
\centering
% \caption{My caption}
% \label{my-label}
\ttfamily
% \small
\newcolumntype{k}{p{3cm}}
\newcolumntype{v}{X}
\newcolumntype{t}{p{\textwidth - 4\tabcolsep - 3cm - 3\arrayrulewidth}}
\begin{tabularx}{1\textwidth}{|k|v|k|v|}
\hline
FTK No.  & 1139  & Evidence No.  & \textbf{DS01}  \tabularnewline \hline
Filename  & \multicolumn{3}{t|}{Bad Guy.contact}  \tabularnewline \hline
Hash (MD5)  & \multicolumn{3}{t|}{721fa07cecb880951fb675944f3607b4}  \tabularnewline \hline
Hash (SHA1)  & \multicolumn{3}{t|}{3c6df384298894d2db5b076cd3e566568c1db466}  \tabularnewline \hline
Date Created  & \multicolumn{3}{t|}{20/02/2018 12:05:58 UTC}  \tabularnewline \hline
Date Modified  & \multicolumn{3}{t|}{20/02/2018 12:07:48 UTC}  \tabularnewline \hline
Date Accessed  & \multicolumn{3}{t|}{20/02/2018}  \tabularnewline \hline
Is deleted?  & \multicolumn{3}{t|}{No}  \tabularnewline \hline
Size (L/P)  & \multicolumn{3}{t|}{2069 B / 8192 B}  \tabularnewline \hline
File path  & \multicolumn{3}{t|}{Bad\_Guy.E01/NONAME [FAT32]/[root]/Documents/soup/b/g/Bad Guy.contact}  \tabularnewline \hline
Evidence Description  & \multicolumn{3}{t|}{
An XML `.contact' file that contains Mr. Bad Guy's contact details -- notably, his email address is `bad.guy@secret.net'
}  \tabularnewline \hline
Technique used  & \multicolumn{3}{t|}{
The technique used to find this file was to:
\begin{enumerate}
  \item Go to the `Overview' tab
  \item Select the `File Extension' view
  \item Select `contact' extension
\end{enumerate}
In the `File List' pane, there are 4 files shown -- 3 have been deleted and the artefact file is the file that has been moved from the `[root]' of the drive into a subfolder inside `Documents' in an attempt to hide it.
}  \tabularnewline \hline
Reason for selection  & \multicolumn{3}{t|}{
This file was selected because it links Mr.\ Bad Guy to the 16GB red USB memory stick that was recovered from his pocket during his arrest.
}  \tabularnewline \hline
\end{tabularx}
\end{table}

\pagebreak
\subsection{Artefact 2}
% Name	Label	Item #	Ext	Path	Category	P-Size (bytes)	L-Size (bytes)	MD5	SHA1	SHA256	Created	Accessed	Modified
% !WRD0643.TMP		18441	tmp	Bad_Guy.E01/NONAME [FAT32]/[root]/Documents/it stuff/!WRD0643.TMP	Encrypted Word 2010	24576	18432	01b85c739b8de7479ff9b91e9a24213d	1d71f415cffa0b86274a1335e9a970f90d880885		17/02/2017 11:23:43 (2017-02-17 11:23:43 UTC)	n/a	17/02/2017 11:25:36 (2017-02-17 11:25:36 UTC)

\begin{table}[h!]
\centering
% \caption{My caption}
% \label{my-label}
\ttfamily
% \small
% \newcolumntype{k}{b{3cm}}
\newcolumntype{k}{p{3cm}}
\newcolumntype{v}{X}
\newcolumntype{t}{p{\textwidth - 4\tabcolsep - 3cm - 3\arrayrulewidth}}
\begin{tabularx}{1\textwidth}{|k|v|k|v|}
\hline
FTK No.  & 18441  & Evidence No.  & \textbf{DS02}  \tabularnewline \hline
Filename  & \multicolumn{3}{t|}{!WRD0643.TMP}  \tabularnewline \hline
Hash (MD5)  & \multicolumn{3}{t|}{01b85c739b8de7479ff9b91e9a24213d}  \tabularnewline \hline
Hash (SHA1)  & \multicolumn{3}{t|}{1d71f415cffa0b86274a1335e9a970f90d880885}  \tabularnewline \hline
Date Created  & \multicolumn{3}{t|}{17/02/2017 11:23:43 UTC}  \tabularnewline \hline
Date Modified  & \multicolumn{3}{t|}{17/02/2017 11:25:36 UTC}  \tabularnewline \hline
Date Accessed  & \multicolumn{3}{t|}{17/02/2017}  \tabularnewline \hline
Is deleted?  & \multicolumn{3}{t|}{No}  \tabularnewline \hline
Size (L/P)  & \multicolumn{3}{t|}{18432 B / 24576 B}  \tabularnewline \hline
File path  & \multicolumn{3}{t|}{Bad\_Guy.E01/NONAME [FAT32]/[root]/Documents/it stuff/!WRD0643.TMP}  \tabularnewline \hline
% {\vspace{-4em minus \baselineskip}Evidence Description}  & \multicolumn{3}{t|}{
{\vspace{-4.4em}Evidence Description}  & \multicolumn{3}{t|}{
\makecell[{{p{\textwidth - 4\tabcolsep - 3cm - 3\arrayrulewidth}}}]{
An encrypted Microsoft Office Word 2010 temporary file.\\
Decryption of this file using `PRTK` (password: `brycecanyon`) revealed the contents:\\
``I have broke into their restricted network and put a backdoor account into their system.\\
Username: adam\\
Password: isthebesthackerever!''
}}  \tabularnewline \hline
Technique used  & \multicolumn{3}{t|}{
In order to find this evidence artefact:
\begin{enumerate}
  \item Go to `Overview tab > File Status > Encrypted Files' and export the files
  \item Open `PRTK', import the encrypted files, and attempt to decrypt them
  \item Go to `Tools > Decrypt Files...'' and add the passwords that `PRTK' returned
  \item Go to `Overview tab > File Status > Decrypted Files' and select `Decrypted - !WRD0643.TMP' in the `File List' pane
  \item View the contents of the decrypted file in the `File Content > Natural' pane
\end{enumerate}
}  \tabularnewline \hline
Reason for selection  & \multicolumn{3}{t|}{
This artefact was selected because the file author details how they broke into a restricted network and inserted a backdoor account on a system -- violations of the \textit{Computer Misuse Act 1990}.
}  \tabularnewline \hline
\end{tabularx}
\end{table}

\pagebreak
\section{Passwords Recovered}


% ------------------------------------------------------------------------------
% \begin{table}[h!]
%   \centering
%   \begin{tabular}{|r l|}
%     \hline
%     IP address: & 192.168.254.132 \\
%     \hline
%     Operating system: & Linux Ubuntu 4.13.0-17-generic x86\_64 \\
%     \hline
%     Open ports: & 80 \textit{[http]}, 442 \textit{[ssh; OpenSSH 7.5p1 Ubuntu 10]} \\
%     \hline
%     Closed ports: & 443 \textit{[https]} \\
%     \hline
%     Price's groups: & phillip adm cdrom sudo dip www-data plugdev lpadmin sambashare \\
%     \hline
%   \end{tabular}
%   \caption{Information on Price's machine and account}
%   \label{table:pricemachineinfo}
% \end{table}

% \begin{Verbatim}[frame=leftline]
% Loaded 393 passwords from 'passwords.txt'
% (001/393; 00.25%) Password != '0'
% (002/393; 00.51%) Password != 'scorpio'
% (003/393; 00.76%) Password != 'buddy'
% ...
% (222/393; 56.49%) Password != 'trustno1'
% (223/393; 56.74%) Password != 'newyork'
% (224/393; 57.00%) Password == 'qwertyuiop'
% Took 0.96 minutes to check 224/393 passwords at a rate of 3.88pw/s.
% Performing recon...
% Logging out.
% \end{Verbatim}

% \begin{Verbatim}[frame=leftline]
% [User]
% Language=en_GB
% FormatsLocale=en_GB.UTF-8
% XSession=
% SystemAccount=true
%
% [InputSource0]
% xkb=gb
% \end{Verbatim}
% ------------------------------------------------------------------------------

% BIBLIOGRAPHY/REFERENCES
\pagebreak
% nocited refs
% \nocite{example:referenceid:here}

% Insert references section, left aligned
\begin{flushleft}
  \bibliography{references}
\end{flushleft}


% APPENDICES
% Appendix~\ref{app:screenshots:7}
% \appendix

% \pagebreak
% \chapter{Screenshot deliverables}
% \section{\texttt{ifconfig}, \texttt{arp-scan}, and \texttt{nmap}}
% \label{app:screenshots:1}
% \begin{figure}[H]
%   \centering
%   \includegraphics[width=0.7\paperheight, angle=-90]{It's_Elementary_my_dear_Watson!-2017-12-06-13-41-10}
% \end{figure}
% \pagebreak

% \pagebreak
% \chapter{File deliverables}
% \section{\texttt{recon.txt}}
% \label{app:files:recon}
% \lstinputlisting[frame=single, basicstyle=\small\ttfamily, showstringspaces=false, breaklines=true, postbreak=\mbox{\textcolor{gray}{$\hookrightarrow$}\space}]{deliverables/files/recon.txt}


\end{document}
